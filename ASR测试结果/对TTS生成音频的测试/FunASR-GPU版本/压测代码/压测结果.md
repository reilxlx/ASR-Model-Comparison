### 以下测试结果基于4090显卡进行：

```
(SenseVoice) root@ubuntu22:/workspace/samples/python# python load_test_by_txt_tqdm.py    --url "http://127.0.0.1:8000/transcribe?host=127.0.0.1&port=10098&mode=offline&ssl=false&use_itn=true&audio_fs=16000"     --audio-file "/root/home/fish-speech-liutao-16k/sentence_104.wav"     --concurrency-levels "1,5,10,15,20,25,30"     --requests-per-level 1000
Starting load test...
API URL: http://127.0.0.1:8000/transcribe?host=127.0.0.1&port=10098&mode=offline&ssl=false&use_itn=true&audio_fs=16000
Audio File: /root/home/fish-speech-liutao-16k/sentence_104.wav
Requests per level: 1000
Concurrency levels: [1, 5, 10, 15, 20, 25, 30]
Expected Text (start): '我们注意到您近期咨询了关于我行星推出的一款结构性理财产品。这款产品本金相对安全，其预期收益与特定的市...'
----------------------------------------
Running Conc=1:   0%|                                                                                                               | 0/7 [00:00<?, ?level/s]2025-05-02 10:58:39,989 - INFO - Success Criterion: Exact match for text starting with '我们注意到您近期咨询了关于我行星推出的一款结构性理财产品。这...'
2025-05-02 10:58:39,990 - INFO - Loaded audio file: sentence_104.wav (1089372 bytes)
Conc=1  : 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [21:16<00:00,  1.28s/req]
Conc=1  : 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [21:16<00:00,  1.25s/req]
--- Test Summary: Concurrency=1 ---
Total Requests Sent:      1000
Successful Requests (Exact Match): 1000
Failed Requests:          0
Success Rate (Exact Match): 100.00%
Total Test Duration:      0:21:16.364378
Avg. Resp. Time (Success):1.276 seconds
Status Code Counts:       {200: 1000}
--- Test Finished: Concurrency=1 ---

Running Conc=5:  14%|██████████████▏                                                                                    | 1/7 [21:16<2:07:38, 1276.37s/level]2025-05-02 11:19:56,355 - INFO - Success Criterion: Exact match for text starting with '我们注意到您近期咨询了关于我行星推出的一款结构性理财产品。这...'
2025-05-02 11:19:56,356 - INFO - Loaded audio file: sentence_104.wav (1089372 bytes)
Conc=5  : 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [04:40<00:00,  3.56req/s]
Conc=5  : 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [04:40<00:00,  3.79req/s]
--- Test Summary: Concurrency=5 ---
Total Requests Sent:      1000
Successful Requests (Exact Match): 1000
Failed Requests:          0
Success Rate (Exact Match): 100.00%
Total Test Duration:      0:04:40.860483
Avg. Resp. Time (Success):1.401 seconds
Status Code Counts:       {200: 1000}
--- Test Finished: Concurrency=5 ---

Running Conc=10:  29%|████████████████████████████▊                                                                        | 2/7 [25:57<57:33, 690.78s/level]2025-05-02 11:24:37,218 - INFO - Success Criterion: Exact match for text starting with '我们注意到您近期咨询了关于我行星推出的一款结构性理财产品。这...'
2025-05-02 11:24:37,218 - INFO - Loaded audio file: sentence_104.wav (1089372 bytes)
Conc=10 : 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [02:50<00:00,  5.86req/s]
Conc=10 : 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [02:50<00:00,  6.49req/s]
--- Test Summary: Concurrency=10 ---
Total Requests Sent:      1000
Successful Requests (Exact Match): 1000
Failed Requests:          0
Success Rate (Exact Match): 100.00%
Total Test Duration:      0:02:50.531167
Avg. Resp. Time (Success):1.698 seconds
Status Code Counts:       {200: 1000}
--- Test Finished: Concurrency=10 ---

Running Conc=15:  43%|███████████████████████████████████████████▎                                                         | 3/7 [28:47<30:12, 453.22s/level]2025-05-02 11:27:27,751 - INFO - Success Criterion: Exact match for text starting with '我们注意到您近期咨询了关于我行星推出的一款结构性理财产品。这...'
2025-05-02 11:27:27,751 - INFO - Loaded audio file: sentence_104.wav (1089372 bytes)
Conc=15 : 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [02:42<00:00,  6.16req/s]
Conc=15 : 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [02:42<00:00, 10.83req/s]
--- Test Summary: Concurrency=15 ---
Total Requests Sent:      1000
Successful Requests (Exact Match): 1000
Failed Requests:          0
Success Rate (Exact Match): 100.00%
Total Test Duration:      0:02:42.296151
Avg. Resp. Time (Success):2.425 seconds
Status Code Counts:       {200: 1000}
--- Test Finished: Concurrency=15 ---

Running Conc=20:  57%|█████████████████████████████████████████████████████████▋                                           | 4/7 [31:30<16:55, 338.37s/level]2025-05-02 11:30:10,049 - INFO - Success Criterion: Exact match for text starting with '我们注意到您近期咨询了关于我行星推出的一款结构性理财产品。这...'
2025-05-02 11:30:10,049 - INFO - Loaded audio file: sentence_104.wav (1089372 bytes)
Conc=20 : 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [02:45<00:00,  6.05req/s]
Conc=20 : 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [02:45<00:00, 17.02req/s]
--- Test Summary: Concurrency=20 ---
Total Requests Sent:      1000
Successful Requests (Exact Match): 1000
Failed Requests:          0
Success Rate (Exact Match): 100.00%
Total Test Duration:      0:02:45.356489
Avg. Resp. Time (Success):3.291 seconds
Status Code Counts:       {200: 1000}
--- Test Finished: Concurrency=20 ---

Running Conc=25:  71%|████████████████████████████████████████████████████████████████████████▏                            | 5/7 [34:15<09:11, 275.98s/level]2025-05-02 11:32:55,407 - INFO - Success Criterion: Exact match for text starting with '我们注意到您近期咨询了关于我行星推出的一款结构性理财产品。这...'
2025-05-02 11:32:55,407 - INFO - Loaded audio file: sentence_104.wav (1089372 bytes)
Conc=25 : 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [02:45<00:00,  6.06req/s]
Conc=25 : 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏| 997/1000 [02:44<00:00, 11.01req/s]
--- Test Summary: Concurrency=25 ---
Total Requests Sent:      1000
Successful Requests (Exact Match): 1000
Failed Requests:          0
Success Rate (Exact Match): 100.00%
Total Test Duration:      0:02:45.017853
Avg. Resp. Time (Success):4.100 seconds
Status Code Counts:       {200: 1000}
--- Test Finished: Concurrency=25 ---

Running Conc=30:  86%|██████████████████████████████████████████████████████████████████████████████████████▌              | 6/7 [37:00<03:58, 238.25s/level]2025-05-02 11:35:40,427 - INFO - Success Criterion: Exact match for text starting with '我们注意到您近期咨询了关于我行星推出的一款结构性理财产品。这...'
2025-05-02 11:35:40,427 - INFO - Loaded audio file: sentence_104.wav (1089372 bytes)
Conc=30 : 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [02:45<00:00,  6.03req/s]
Conc=30 : 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋| 999/1000 [02:45<00:00, 12.73req/s]
--- Test Summary: Concurrency=30 ---
Total Requests Sent:      1000
Successful Requests (Exact Match): 1000
Failed Requests:          0
Success Rate (Exact Match): 100.00%
Total Test Duration:      0:02:45.965033
Avg. Resp. Time (Success):4.939 seconds
Status Code Counts:       {200: 1000}
--- Test Finished: Concurrency=30 ---

Running Conc=30: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [39:46<00:00, 340.91s/level]
========================================
Overall Load Test Complete
========================================
(SenseVoice) root@ubuntu22:/workspace/samples/python# 
```

**分析:**

1.  **可靠性与准确性 (依然完美):**
    *   **观察:** 在所有测试的并发级别下（1, 5, 10, 15, 20, 25, 30），`成功率 (精确匹配)` 始终是 **100%**。失败请求数为 **零**。
    *   **结论:** 系统（API 封装 + FunASR 后端）对于这个音频文件 (`sentence_104.wav`) 表现出极高的稳定性和准确性，即使在高达 30 个并发任务的情况下，也能持续稳定地提供正确的转录结果。

2.  **性能与延迟 (出现拐点/更趋近线性):**
    *   **观察:** `平均响应时间（成功请求）` 随并发增加而增长：
        *   并发 1: **1.276 秒**
        *   并发 5: **1.401 秒** (+0.13 秒)
        *   并发 10: **1.698 秒** (+0.30 秒)
        *   并发 15: **2.425 秒** (+0.73 秒)
        *   并发 20: **3.291 秒** (+0.87 秒)
        *   并发 25: **4.100 秒** (+0.81 秒)
        *   并发 30: **4.939 秒** (+0.84 秒)
    *   **结论:**
        *   **低并发区 (1-10):** 延迟增长相对缓慢。从并发 1 到 10，平均响应时间只增加了约 0.4 秒。这表明在此负载范围内，系统资源相对充足。
        *   **高并发区 (10-30):** 延迟增长变得更加显著且接近线性。从并发 10 到 30，每次增加 5 个并发用户，平均响应时间大约增加 0.7 到 0.8 秒。这进一步证实了系统资源（很可能是后端处理单元）在并发数超过 10 之后开始变得紧张，请求开始排队或等待资源。

3.  **吞吐量 (达到并维持饱和):**
    *   **观察:** 计算近似 RPS：
        *   并发 1: 1000 / (21\*60 + 16.4) ≈ 1000 / 1276.4 ≈ **0.78 RPS** (注意：单并发下由于没有并行处理，总时间很长，RPS 很低)
        *   并发 5: 1000 / (4\*60 + 40.9) ≈ 1000 / 280.9 ≈ **3.56 RPS**
        *   并发 10: 1000 / (2\*60 + 50.5) ≈ 1000 / 170.5 ≈ **5.86 RPS**
        *   并发 15: 1000 / (2\*60 + 42.3) ≈ 1000 / 162.3 ≈ **6.16 RPS**
        *   并发 20: 1000 / (2\*60 + 45.4) ≈ 1000 / 165.4 ≈ **6.05 RPS**
        *   并发 25: 1000 / (2\*60 + 45.0) ≈ 1000 / 165.0 ≈ **6.06 RPS**
        *   并发 30: 1000 / (2\*60 + 46.0) ≈ 1000 / 166.0 ≈ **6.02 RPS**
    *   **结论:**
        *   **显著提升 (1-10):** 吞吐量从单并发的不足 1 RPS 迅速提升到并发 10 时的近 6 RPS。这表明增加并发可以有效利用系统资源，提高处理效率。
        *   **饱和点 (10-15 左右):** 在并发 10 到 15 之间，吞吐量达到了峰值，大约在 **6.0 - 6.2 RPS**。
        *   **平台期 (15-30):** 当并发数从 15 增加到 30 时，整体吞吐量**几乎没有增长**，稳定在 6 RPS 左右。这清楚地表明系统的最大处理能力（对于这个特定音频和配置）大约就是 6 RPS。

4.  **稳定性 (持续优秀):**
    *   **Observation:** 所有请求仍然返回 HTTP `200` 状态码，没有报告任何失败（包括连接错误、超时、文本不匹配等）。
    *   **Conclusion:** 系统即使在达到其吞吐量极限时，依然保持稳定运行，没有出现崩溃或错误。

**综合信息与结论:**

*   **准确性与稳定性:** 服务非常可靠，即使在达到性能瓶颈时也能保证 100% 的准确率和稳定性。
*   **性能拐点:** 大约在 **并发 10-15** 时，系统达到了其处理能力的 **饱和点**。
*   **最佳并发区间 (可能):** 如果目标是在保持相对较低延迟（例如 < 2秒）的同时最大化吞吐量，那么并发 10 似乎是一个较好的平衡点 (1.7秒延迟, 5.86 RPS)。如果可以容忍更高的延迟（2.4秒），并发 15 可以达到峰值吞吐量 (~6.16 RPS)。
*   **吞吐量上限:** 对于这个特定的音频文件和服务器设置，系统的最大吞吐量约为 **6 RPS**。
*   **资源限制:** 增加并发数超过 15 并不能提高整体效率，只会导致每个请求等待更长时间，这表明后端处理资源（如 CPU/GPU/FunASR 实例）是主要的限制因素。
*   **与上次测试对比:** 这次测试似乎显示了更高的峰值吞吐量（约 6 RPS vs 上次的约 3.5-4 RPS）。可能的原因包括：
    *   服务器配置或资源分配不同（例如，更多的 CPU/GPU 或 FunASR worker）。
    *   测试环境的网络状况更好。
    *   测试脚本或 API 本身的细微优化（虽然代码看起来相似）。
    *   第一次测试时可能存在其他后台进程占用了资源。

**核心 takeaway:** 系统很稳定，但在并发 10-15 左右达到性能瓶颈，最大处理能力约为 6 RPS。高于此并发数会导致延迟显著增加而吞吐量不再提升。